(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{395:function(e,t,a){"use strict";a.r(t);var r=a(42),n=Object(r.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"flutter-webview使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flutter-webview使用"}},[e._v("#")]),e._v(" Flutter WebView使用")]),e._v(" "),a("blockquote",[a("p",[e._v("一个完整的WebView要有与JS交互和拦截URL的功能")])]),e._v(" "),a("p",[e._v("使用过人气很高的"),a("a",{attrs:{href:"https://github.com/fluttercommunity/flutter_webview_plugin",target:"_blank",rel:"noopener noreferrer"}},[e._v("flutter_webview_plugin"),a("OutboundLink")],1),e._v("，但是缺少2个重要的功能。也在打开多个WebView时会出错。")]),e._v(" "),a("ul",[a("li",[e._v("不能在JS中调用Flutter方法")]),e._v(" "),a("li",[e._v("不能在H5进入某个URL之前拦截")])]),e._v(" "),a("p",[e._v("虽然该插件不够完整，但是使用起来很方便，封装了很多功能。如果交互不多可以用该插件。")]),e._v(" "),a("h3",{attrs:{id:"官方的-webview-flutter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#官方的-webview-flutter"}},[e._v("#")]),e._v(" 官方的 webview_flutter")]),e._v(" "),a("p",[e._v("之后使用官方的"),a("a",{attrs:{href:"https://pub.dev/packages/webview_flutter",target:"_blank",rel:"noopener noreferrer"}},[e._v("webview_flutter"),a("OutboundLink")],1),e._v("插件。")]),e._v(" "),a("p",[e._v("附：")]),e._v(" "),a("p",[e._v("在老版本的 Flutter WebView有在Android中无法调弹出键盘的问题，在"),a("code",[e._v("webview_flutter Version 0.3.10+2")]),e._v("中已经修复该BUG，使用最新版的Flutter SDK ("),a("code",[e._v("flutter _v1.7.8+hotfix.3-stable")]),e._v(")")]),e._v(" "),a("p",[e._v("见GitHub Issue："),a("a",{attrs:{href:"https://github.com/flutter/flutter/issues/19718",target:"_blank",rel:"noopener noreferrer"}},[e._v("issues/19718"),a("OutboundLink")],1)]),e._v(" "),a("p",[e._v("真的很好用。官方的Example也很到位哈。")]),e._v(" "),a("h3",{attrs:{id:"js调用flutter"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#js调用flutter"}},[e._v("#")]),e._v(" JS调用Flutter")]),e._v(" "),a("p",[e._v("使用实例：")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    // 定义方法\n    JavascriptChannel _toasterJavascriptChannel(BuildContext context) {\n        return JavascriptChannel(\n            name: 'Toaster',\n            onMessageReceived: (JavascriptMessage message) {\n            Scaffold.of(context).showSnackBar(\n                SnackBar(content: Text(message.message)),\n            );\n            });\n    }\n    \n    // 暴露给WebView\n    WebView(\n        // ... 略\n        javascriptChannels: <JavascriptChannel>[\n            _toasterJavascriptChannel(context),\n        ].toSet(),\n    )\n\n    // JS调用方法\n    Toaster.postMessage('弹弹乐');\n")])])]),a("h3",{attrs:{id:"flutter调用js"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flutter调用js"}},[e._v("#")]),e._v(" Flutter调用JS")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    WebViewController _webViewController;\n\n    WebView(\n        // ... 略\n        javascriptMode: JavascriptMode.unrestricted, // 使用JS没限制\n        onWebViewCreated: (WebViewController webViewController) {\n            // 在WebView创建完成后会产生一个 webViewController\n            _webViewController = webViewController;\n        },\n    )\n\n    // 之后可以调用 _webViewController 的 evaluateJavascript 属性来注入JS\n    _webViewController.evaluateJavascript(\"Toaster.postMessage('弹弹乐');\");\n")])])]),a("h3",{attrs:{id:"拦截url"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拦截url"}},[e._v("#")]),e._v(" 拦截URL")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("    WebView(\n        navigationDelegate: (NavigationRequest request) {\n            // 判断URL\n            if (request.url.startsWith('https://www.baidu.com')) {\n                // 做一些事情\n                // 阻止进入登录页面\n                return NavigationDecision.prevent;\n            }\n            return NavigationDecision.navigate;\n        },\n    );\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);